<?xml version="1.0" encoding="utf-8"?>
<X3D profile='H3DAPI' version='1.4'>
	<head>
		<meta name='title' content='FrameBufferTextureGenerator_texturearray.x3d'/>
		<meta name='description' content='H3DAPI FrameBufferTextureGenerator example. It shows generate a 2D texture array from the rendering ONE sub-scene (using the geometry shader and gl_Layer index) and display them on to separate rectangles.  This example uses H3DAPI node(s) and runs on H3DAPI-supported browsers only. Visit http://www.h3d.org for more information and to download an H3DAPI-
      compatible browser. '/>
		<meta name='author' content='SenseGraphics AB, 2006-2014'/>
	</head>

	<Scene>
		<Viewpoint position='-0.05 -0.2 0.8' />

		<Group>
			<Background skyColor="0.3 0.3 0.3" />
		
			<FrameBufferTextureGenerator DEF="GEN" outputTextureType="2D_ARRAY"  generateColorTextures='"RGBA"' nrLayers='32' samples="0" generateDepthTexture="false" >
				<Shape>
					<Appearance>
						<ComposedShader language="GLSL">
							<ShaderPart type="VERTEX" url="shaders/32_layers.vert" />
							<ShaderPart type="GEOMETRY" url="shaders/32_layers.geo" />
							<ShaderPart type="FRAGMENT" url="shaders/32_layers.frag" />
						</ComposedShader>
					</Appearance>
					<Sphere radius="0.1" />
				</Shape>

			</FrameBufferTextureGenerator>

			<!-- First row -->
			<Transform translation="-0.5 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER0" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="0" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="-0.4 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER1" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="1" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>


			<Transform translation="-0.3 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER2" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="2" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="-0.2 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER3" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="3" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="-0.1 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER4" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="4" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.0 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER5" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="5" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.1 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER6" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="6" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.2 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER7" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="7" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.3 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER8" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="8" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.4 0 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER9" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="9" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>
			
			
			
		<!-- Second row -->			
	<Transform translation="-0.5 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER10" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="10" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="-0.4 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER11" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="11" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>


			<Transform translation="-0.3 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER12" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="12" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="-0.2 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER13" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="13" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="-0.1 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER14" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="14" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.0 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER15" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="15" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.1 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER16" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="16" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.2 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER17" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="17" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.3 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER18" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="18" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.4 -0.1 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER19" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="19" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>
			
			
			
					<!-- Third row -->			
	<Transform translation="-0.5 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER20" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="20" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="-0.4 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER21" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="21" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>


			<Transform translation="-0.3 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER22" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="22" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="-0.2 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER23" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="23" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="-0.1 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER24" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="24" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.0 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER25" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="25" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.1 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER26" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="26" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.2 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER27" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="27" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.3 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER28" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="28" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>

			<Transform translation="0.4 -0.2 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER29" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="29" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>
			
		<!-- Fourth layer -->
		<Transform translation="-0.5 -0.3 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER30" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="30" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>
			
						<Transform translation="-0.4 -0.3 0">
				<Shape>
					<Appearance>
						<ComposedShader DEF="SHADER31" language="GLSL">
							<field name="texArray" type="MFNode" accessType="inputOutput"/>
							<field name="arrayIndex" type="SFInt32" value="31" accessType="inputOutput" />
							<ShaderPart type="VERTEX" url="shaders/mrt.vert" />
							<ShaderPart type="FRAGMENT" url="shaders/texarray.frag" />
						</ComposedShader>
					</Appearance>
					<Rectangle2D size="0.1 0.1"/>
				</Shape>
			</Transform>
		</Group>

		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER0" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER1" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER2" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER3" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER4" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER5" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER6" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER7" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER8" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER9" toField="texArray" />
		
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER10" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER11" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER12" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER13" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER14" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER15" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER16" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER17" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER18" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER19" toField="texArray" />
		
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER20" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER21" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER22" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER23" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER24" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER25" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER26" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER27" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER28" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER29" toField="texArray" />
		
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER30" toField="texArray" />
		<ROUTE fromNode="GEN" fromField="colorTextures" toNode="SHADER31" toField="texArray" />
	</Scene>
</X3D>
